apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: default
labels:
  - includeSelectors: true
    pairs:
      env: staging
namePrefix: stg-
resources:
  - ../base
  - image-policy.yaml
  - ingress.yaml
images:
  - name: auth
    newName: ghcr.io/piny940/auth-backend # {"$imagepolicy": "default:stg-auth:name"}
    newTag: stg-126c25b911969265caf03a8e6b30c8e1df955f78-83 # {"$imagepolicy": "default:stg-auth:tag"}
  - name: auth-frontend
    newName: ghcr.io/piny940/auth-frontend # {"$imagepolicy": "default:stg-auth-frontend:name"}
    newTag: stg-ef717453ef1088717c07665481a0c4593f673129-81 # {"$imagepolicy": "default:stg-auth-frontend:tag"}
  - name: auth-example
    newName: ghcr.io/piny940/auth-example # {"$imagepolicy": "default:stg-auth-example:name"}
    newTag: stg-126c25b911969265caf03a8e6b30c8e1df955f78-83 # {"$imagepolicy": "default:stg-auth-example:tag"}
configMapGenerator:
  - name: auth-conf
    behavior: merge
    literals:
      - DB_NAME=auth_staging
      - SERVER_URL=https://stg-auth.piny940.com/api/v1
      - API_LOGIN_URL=https://stg-auth.piny940.com/
      - API_APPROVE_URL=https://stg-auth.piny940.com/approve
      - OAUTH_ISSUER=https://stg-auth.piny940.com
      - NEXT_PUBLIC_API_URL=https://stg-auth.piny940.com/api/v1
      - NEXT_PUBLIC_APP_URL=https://auth-example.piny940.com
      - |
        SERVER_PUBLIC_KEY=-----BEGIN PUBLIC KEY-----
        MIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEAnFgrAP99vJSgpyUc1+3s
        qQiJIUFXRSemluANCdmfhz4cPKuG/Yp6dxndR50yjc1TWosC5RhPpe/64sV6VRev
        EXNhFVvfeplfHP4aCZFWETHA7i8ikAwkZPoklgx9q0O3EifENmrOFigDFiz9YQSi
        V7Um9X8Avph/CI5xYOgS4ZavC4Sq/nm3YgmuyaVI6xh3ceAFHZWsJ0NlI8in9nfg
        /ZKHwz/SJY9Pa7VlGjce50b7BbpvJW7+fR86rcYwm1a83rfHgvyX8LdTqQYZJp0w
        bMupEhkZX4tS349Hb6Ie4Tz/opCCXJe7R8lgviUAFGparOoP4KX3wRO8C3obTKoz
        2j/L+YaSLjLOE6a4OE9oKdzC3tL4ISiOeSQp95F4G3wn8/0JqqLeVJJZ83rjIf0c
        zc07s1NECBn67RxnFIySyd4uFcJI4VM20PH7RO+PtPziypsi0k85qAfv7zBhPvYB
        NGoh3ZKCnxP1s9PPc/l1kntBluhz2WL5tPIVQhpJK3TrAgMBAAE=
        -----END PUBLIC KEY-----
