apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: default
labels:
  - includeSelectors: true
    pairs:
      env: production
resources:
  - ../base
  - image-policy.yaml
  - ingress.yaml
images:
  - name: auth
    newName: ghcr.io/piny940/auth-backend # {"$imagepolicy": "default:auth:name"}
    newTag: 1.0.22 # {"$imagepolicy": "default:auth:tag"}
  - name: auth-frontend
    newName: ghcr.io/piny940/auth-frontend # {"$imagepolicy": "default:auth-frontend:name"}
    newTag: 1.0.21 # {"$imagepolicy": "default:auth-frontend:tag"}
configMapGenerator:
  - name: auth-conf
    behavior: merge
    literals:
      - DB_NAME=auth
      - SERVER_URL=https://auth.piny940.com/api/v1
      - API_LOGIN_URL=https://auth.piny940.com/
      - API_APPROVE_URL=https://auth.piny940.com/approve
      - OAUTH_ISSUER=https://auth.piny940.com
      - NEXT_PUBLIC_API_URL=https://auth.piny940.com/api/v1
      - NEXT_PUBLIC_APP_URL=https://auth-example.piny940.com
      - |
        SERVER_PUBLIC_KEY=-----BEGIN PUBLIC KEY-----
        MIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEAu9Cf1nLJUKkg+F9J4AU4
        q6UkQV0uqSM2nqHlw8V9IhtIVMUERT+H1S4HcN9ftik0LB25Sw1JFc2BScBCDmfp
        Fr3sIcUAhnquN77Z/Zgj/O0Td7wPdSXgf0Pn5EO+QHKYgcqmZ4dtyMn5ZztDiAxP
        bKv7Ac4QpFZ/aWtPdzO4iMBr6rVmmh1JjfB9pAurV++7kh2ZKUH8JBmxa1/CKXeh
        n+2QVbPgqr/jxdaR8fEC4PrgXuTruG86FeJNke8+SrpiDh9A9JeFQZXA1pmsSTFg
        rOq5fSl/FEWLPANREj5+1q1wPOl2KEC1SILcadtZCzttophzqTgzAZUNtQP0/Iob
        EGi1D6pCMK2Bwr7uQnbis+M4BazeXlLH9WGZgeOYmj8C3IW2lLTAHOfUicIyHlWX
        zXAdUfDMbVn+E985cd0qpdXoq/6UPT448FAn+eR4tn1IfcfcsUkiuDrevFiIGyAi
        83ZqAPwkyzXSGa08AgXxgE56o0GmgvpSy9jcrLhnR6J1AgMBAAE=
        -----END PUBLIC KEY-----
